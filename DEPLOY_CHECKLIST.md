# 部署检查清单

在部署到生产环境之前，请确保完成以下检查：

## ✅ 代码准备

- [ ] 代码已推送到GitHub
- [ ] 所有敏感信息已从代码中移除
- [ ] `.env` 文件已添加到 `.gitignore`
- [ ] 代码已通过测试（如果有）

## ✅ 环境变量配置

### 必需变量
- [ ] `JWT_SECRET` - 已设置为强随机字符串
- [ ] `ADMIN_SECRET` - 已设置为强随机字符串
- [ ] `DEFAULT_APP_SECRET` - 已设置为强随机字符串
- [ ] `ADMIN_PASSWORD` - 已修改为安全密码

### 数据库配置
- [ ] `DB_TYPE` - 已设置（sqlite 或 postgres）
- [ ] SQLite: `SQLITE_DB_PATH` 已配置
- [ ] PostgreSQL: 所有连接参数已配置

### 可选配置
- [ ] 存储配置（R2/腾讯云COS）- 如需要
- [ ] 短信配置（smsbao）- 如需要
- [ ] 邮件配置 - 如需要

## ✅ 安全设置

- [ ] 所有默认密码已修改
- [ ] 所有密钥已更换为强随机字符串
- [ ] 生产环境 `NODE_ENV=production`
- [ ] 已配置HTTPS（如适用）
- [ ] 已设置适当的CORS策略

## ✅ 数据库

- [ ] 数据库已初始化（运行 `npm run migrate`）
- [ ] 数据库备份策略已制定
- [ ] 数据库连接正常

## ✅ 部署平台配置

### Railway
- [ ] 已连接GitHub仓库
- [ ] 环境变量已配置
- [ ] 自动部署已启用

### Render
- [ ] 已创建Web Service
- [ ] 构建命令已配置：`npm install && npm run migrate`
- [ ] 启动命令已配置：`npm start`
- [ ] 环境变量已添加

### Docker
- [ ] Dockerfile已测试
- [ ] 镜像构建成功
- [ ] 容器运行正常
- [ ] 数据卷已挂载

## ✅ 功能测试

- [ ] 健康检查端点正常：`GET /health`
- [ ] 管理员登录正常
- [ ] 用户注册/登录正常
- [ ] API接口响应正常
- [ ] 数据库操作正常

## ✅ 监控和日志

- [ ] 已设置日志记录
- [ ] 已配置错误监控（可选）
- [ ] 已设置服务可用性监控（可选）

## ✅ 文档

- [ ] README.md 已更新
- [ ] API文档已更新
- [ ] 部署文档已更新

## 🚀 部署步骤

1. [ ] 选择部署平台
2. [ ] 配置环境变量
3. [ ] 触发部署
4. [ ] 等待构建完成
5. [ ] 运行数据库迁移
6. [ ] 测试健康检查
7. [ ] 测试关键功能
8. [ ] 更新DNS（如适用）
9. [ ] 通知团队成员

## 📝 部署后

- [ ] 记录部署时间
- [ ] 记录部署版本/提交
- [ ] 测试所有关键功能
- [ ] 监控错误日志
- [ ] 检查性能指标

## 🔄 回滚计划

- [ ] 已准备回滚方案
- [ ] 已备份数据库
- [ ] 已记录当前版本

---

**部署日期**: _______________
**部署人员**: _______________
**部署平台**: _______________
**版本/提交**: _______________

